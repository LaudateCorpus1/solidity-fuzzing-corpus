{shr(k,ud)shr(i,n){shr(k,kd)shr(i,d)shr(ig,u)shr(i,n)}shr(k,u){shr(k,kd)shr(i,n){shr(k,kd)shr(i,nh)shr(igk,u)shr(i,n)}shr(gk,u)shr(i,n)}shr(i,n)}